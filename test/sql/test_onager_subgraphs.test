# group: [onager]

require onager
# Test suite for Onager subgraph operations

statement ok
pragma enable_verification

# Create test edge data
statement ok
create table test_edges as select * from (values
  (1::bigint, 2::bigint), (2, 3), (3, 4), (4, 5), (1, 3), (2, 4)
) t(src, dst)

# Test ego graph returns edges
query I
select count(*) > 0 from onager_sub_ego_graph((select src, dst from test_edges), center := 2, radius := 1)
----
1

# Test k-hop neighbors returns nodes
query I
select count(*) > 0 from onager_sub_k_hop((select src, dst from test_edges), start := 1, k := 2)
----
1

# Test k-hop radius 0 returns just the start node
query I
select count(*) from onager_sub_k_hop((select src, dst from test_edges), start := 1, k := 0)
----
1

# Test k-hop with larger radius
query I
select count(*) >= 3 from onager_sub_k_hop((select src, dst from test_edges), start := 1, k := 2)
----
1

# Test induced subgraph returns edges for specified nodes
# The function expects (src, dst, filter_node) columns
query I
select count(*) > 0 from onager_sub_induced((
  select e.src, e.dst, f.node as filter_node
  from test_edges e
  cross join (values (1::bigint), (2::bigint), (3::bigint)) f(node)
))
----
1

# Cleanup
statement ok
drop table test_edges
