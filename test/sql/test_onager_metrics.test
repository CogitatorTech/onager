# group: [onager]

require onager

# Test suite for Onager graph metrics

statement ok
pragma enable_verification

# Create test edge data - simple triangle with one extra edge (1-4)
statement ok
create table test_edges as select * from (values
  (1::bigint, 2::bigint), (2, 3), (3, 1),
  (1, 4)
) t(src, dst)

# Test Diameter
query I
select * from onager_mtr_diameter((select src, dst from test_edges))
----
2

# Test Radius
query I
select * from onager_mtr_radius((select src, dst from test_edges))
----
1

# Test Average Clustering
query R
select round(avg_clustering::numeric, 2) from onager_mtr_avg_clustering((select src, dst from test_edges))
----
0.58

# Test Transitivity
query R
select round(transitivity::numeric, 2) from onager_mtr_transitivity((select src, dst from test_edges))
----
0.60

# Test Triangle Counting
query I
select count(*) from onager_mtr_triangles((select src, dst from test_edges)) where triangles > 0
----
3

# Test Assortativity
query I
select assortativity is not null from onager_mtr_assortativity((select src, dst from test_edges))
----
true

# Cleanup
statement ok
drop table test_edges
