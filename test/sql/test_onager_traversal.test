# group: [onager]


require onager
# Test suite for Onager path and traversal algorithms

statement ok
pragma enable_verification

# Create test edge data
statement ok
create table test_edges as select * from (values
  (1::bigint, 2::bigint), (2, 3), (3, 4)
) t(src, dst)

# Test Dijkstra
query I
select count(*) > 0 from onager_pth_dijkstra((select src, dst from test_edges), source := 1)
----
1

# Test BFS
query I
select count(*) > 0 from onager_trv_bfs((select src, dst from test_edges), source := 1)
----
1

# Test DFS
query I
select count(*) > 0 from onager_trv_dfs((select src, dst from test_edges), source := 1)
----
1

# Create weighted edges for Bellman-Ford
statement ok
create table weighted_edges as select * from (values
  (1::bigint, 2::bigint, 1.0::double),
  (2, 3, 2.0),
  (3, 4, 1.5)
) t(src, dst, weight)

# Test Bellman-Ford
query I
select count(*) > 0 from onager_pth_bellman_ford((select src, dst, weight from weighted_edges), source := 1)
----
1

# Test Floyd-Warshall (all-pairs shortest paths)
query I
select count(*) > 0 from onager_pth_floyd_warshall((select src, dst, weight from weighted_edges))
----
1

# Cleanup
statement ok
drop table test_edges

statement ok
drop table weighted_edges
