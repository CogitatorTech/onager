# group: [onager]

require onager
# Test suite for Onager personalized PageRank
# Note: DuckDB table functions only support one subquery parameter,
# so we test personalized PageRank with a simpler approach

statement ok
pragma enable_verification

# Create test edge data
statement ok
create table test_edges as select * from (values
  (1::bigint, 2::bigint), (2, 3), (3, 4), (4, 5), (1, 3)
) t(src, dst)

# Test that the function exists and returns results
# Using default parameters (no personalization vector)
query I
select count(*) > 0 from onager_ctr_pagerank((select src, dst from test_edges))
----
1

# Test personalized PageRank with a personalization vector
# The function expects (src, dst, personalization_node, personalization_weight)
query I
select count(*) > 0 from onager_ctr_personalized_pagerank((
  select e.src, e.dst, p.node as pers_node, p.weight::double as pers_weight
  from test_edges e
  cross join (values (1::bigint, 1.0::double)) p(node, weight)
))
----
1

# Cleanup
statement ok
drop table test_edges
