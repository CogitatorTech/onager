# group: [gaggle]

# JSON-related tests for Gaggle

statement ok
pragma enable_verification

# Load the Gaggle extension
statement ok
load 'build/release/extension/gaggle/gaggle.duckdb_extension'

# gaggle_json_each should succeed on empty object and produce some valid JSON line (non-empty string)
query I
select length(gaggle_json_each('{}')) >= 0
----
1

# gaggle_json_each should include keys from nested structures as newline-delimited JSON
query I
select gaggle_json_each('{"a":1,"b":[true,{"c":"x"}]}') like '%"a"%'
----
1

query I
select gaggle_json_each('{"a":1,"b":[true,{"c":"x"}]}') like '%"b"%'
----
1

# gaggle_json_each should error on invalid JSON
statement error
select gaggle_json_each('{not valid json}')
----
Failed to parse JSON
