# group: [gaggle]

# Error and argument validation tests for Gaggle

statement ok
pragma enable_verification

# Load the Gaggle extension
statement ok
load 'build/release/extension/gaggle/gaggle.duckdb_extension'

# Wrong arity for gaggle_download should error
statement error
select gaggle_download('a','b')
----
No function matches the given name

# NULL input returns NULL by default (DuckDB default null-handling)
query I
select gaggle_info(NULL) is null
----
1

# Invalid dataset path format should error
statement error
select gaggle_download('owner/too/many/components')
----
Failed

# Replacement scan with invalid kaggle URL should error (no slash)
statement error
select * from 'kaggle:invalid' limit 1
----
kaggle:invalid
